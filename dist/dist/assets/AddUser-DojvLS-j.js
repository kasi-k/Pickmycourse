import{c as q,a as i,r as c,u as L,b as C,j as e,l as $,o as k,d as f,A as y,B as N}from"./index-DTIph_Wm.js";import{A as B}from"./index-kLSoZVNm.js";const U=q().shape({fname:i().trim().required("First name is required").transform(s=>s.toLowerCase()),lname:i().required("Last name is required").transform(s=>s.toLowerCase()),email:i().email("Please Enter a valid Email").trim().required("Email is required"),phone:i().required("Please enter mob.no"),dob:i().required("Please enter Date of birth")}),O=()=>{var u,g,h,j,b;const[s,v]=c.useState(!1),[x,S]=c.useState(null),[w,F]=c.useState(""),[d,A]=c.useState(null),p=L(),{register:t,handleSubmit:E,formState:{errors:r}}=C({resolver:k(U)}),D=m=>{const a=m.target.files[0];if(!a){alert("Please select a file!");return}const l=2*1024*1024;if(a.size>l){alert("File size exceeds 2MB!");return}S(a);const n=new FileReader;n.onload=()=>{const o=n.result;F(o),A(o)},n.readAsDataURL(a)},I=async m=>{v(!0);const a={...m,type:"free"};try{const l=await f.post(`${y}/api/usersignup`,a),n=l.data;if(l.status===200&&x!==null){localStorage.setItem("userid",P.userId._id);const o={name:x.name,user:userid,image:w},P=(await f.post(`${y}/api/images`,o)).data.image;N.success("User and profile Image created Successfully"),p("/users")}else N.success("User created Successfully");p("/users")}catch{console.log("error")}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"font-extralight my-4",children:[e.jsx("p",{className:" mx-2 text-lg ",children:"Add a new user"}),e.jsx("hr",{}),e.jsxs("div",{className:"mx-12 my-6 space-y-1",children:[e.jsx("img",{src:d||$,alt:"Profile",className:`w-40 h-40 ${d?" rounded-3xl object-cover":""}`}),e.jsxs("div",{className:"relative text-base  bg-gradient-to-r from-[#3D03FA] to-[#A71CD2] lg:w-40 md:w-36 w-36 h-12   my-5  ",children:[e.jsx("p",{className:" absolute text-lg  py-2.5 text-center right-2",children:"Upload Image"}),e.jsx("input",{type:"file",onChange:D,className:"opacity-0 w-full h-full"})]})]}),e.jsxs("form",{onSubmit:E(I),children:[e.jsxs("div",{className:"grid lg:grid-cols-12 md:grid-cols-10 mx-6 gap-6 ",children:[e.jsxs("div",{className:"grid col-span-3",children:[e.jsx("label",{children:"First Name"}),e.jsx("input",{...t("fname"),type:"text",placeholder:"Enter First name",className:"outline-none text-black rounded-md py-1.5 px-3 my-3 "}),e.jsx("p",{className:"text-red-700",children:(u=r.fname)==null?void 0:u.message})]}),e.jsxs("div",{className:"grid col-span-3",children:[e.jsx("label",{children:"Last Name"}),e.jsx("input",{...t("lname"),type:"text",placeholder:"Enter Last name",className:"outline-none text-black rounded-md py-1.5 px-3 my-3"}),e.jsx("p",{className:"text-red-700",children:(g=r.lname)==null?void 0:g.message})]}),e.jsxs("div",{className:"grid col-span-3",children:[e.jsx("label",{children:"Email"}),e.jsx("input",{...t("email"),type:"email",placeholder:"Enter Email",className:"outline-none text-black rounded-md py-1.5 px-3 my-3"}),e.jsx("p",{className:"text-red-700",children:(h=r.email)==null?void 0:h.message})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-12 md:grid-cols-10 mx-6 gap-6 my-5",children:[e.jsxs("div",{className:"grid col-span-3",children:[e.jsx("label",{children:"Phone"}),e.jsx("input",{...t("phone"),type:"text",className:"outline-none text-black rounded-md py-1.5 px-3 my-3",placeholder:"Enter Mobile Number"}),e.jsx("p",{className:"text-red-700",children:(j=r.phone)==null?void 0:j.message})]}),e.jsxs("div",{className:"grid col-span-3",children:[e.jsx("label",{children:"Date Of Birth"}),e.jsx("input",{...t("dob"),type:"date",className:"outline-none text-black rounded-md py-1.5 px-3 my-3"}),e.jsx("p",{className:"text-red-700",children:(b=r.dob)==null?void 0:b.message})]})]}),e.jsx("button",{type:"submit",className:`lg:absolute text-lg bottom-10 mx-6   bg-gradient-to-r from-[#3D03FA] to-[#A71CD2] px-16 py-2 ${s?"opacity-50 cursor-not-allowed":""}`,disabled:s,children:s?e.jsxs("div",{className:"flex  text-xl gap-2",children:[e.jsx(B,{className:"h-6 w-6 animate-spin"}),e.jsx("p",{children:"Saving...."})]}):"Save"})]})]})})};export{O as default};
