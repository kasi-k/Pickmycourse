import{r as o,u as D,d as z,A as p,j as e,m as j,n as F,D as I}from"./index-C89U1syM.js";import{P as k,C as M,a as L,E as U,u as i,w as A,b as O}from"./jspdf.plugin.autotable-Ds0HN0ft.js";import{F as $}from"./index-C8JeDtPJ.js";import"./index--_HhYeZn.js";import"./typeof-QjJsDpFa.js";const B=({permissions:r})=>{r==null||r.includes("create");const N=r==null?void 0:r.includes("view"),f=r==null?void 0:r.includes("delete"),[c,g]=o.useState([]),[d,x]=o.useState(!1),[u,w]=o.useState(""),y=D();o.useEffect(()=>{C()},[d]);const C=async()=>{try{const l=(await z.get(`${p}/api/getcourses`)).data;g(l)}catch(s){console.log(s)}},T=s=>{w(`${p}/api/deletecourse/${s}`),x(!0)},P=()=>{x(!1)},n=()=>c.map(s=>({"User Id":s._id,"First Name":s.fname,"Last Name":s.lname,Email:s.email,Phone:s.phone,Topic:s.mainTopic,Type:s.type,Date:j(s.date)})),v=()=>{const s=i.json_to_sheet(n()),l=[{wpx:180},{wpx:100},{wpx:100},{wpx:180},{wpx:80},{wpx:80},{wpx:120},{wpx:100}];s["!cols"]=l;const a=i.book_new();i.book_append_sheet(a,s,"courses"),A(a,"PMC_courses.xlsx")},E=()=>{const s=new O,l=["User Id","First Name","Last Name","Email","Phone","Topic","Type","Date"],a=n().map(t=>[t["User Id"],t["First Name"],t["Last Name"],t.Email,t.Phone,t.Topic,t.Type,t.Date]);s.autoTable({head:[l],body:a,startY:20,theme:"grid",headStyles:{fillColor:[97,144,213],textColor:[255,255,255],fontStyle:"bold",halign:"center"},bodyStyles:{textColor:[0,0,0],halign:"center"}}),s.save("PMC_courses.pdf")},S=(s,l,a,t,m,_)=>{const h=JSON.parse(s);localStorage.setItem("courseId",t),localStorage.setItem("first",m),localStorage.setItem("jsonData",JSON.stringify(h));let b="";m&&(b=_),y("/content",{state:{jsonData:h,mainTopic:l.toUpperCase(),type:a.toLowerCase(),courseId:t,end:b}})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:" font-extralight",children:[e.jsxs("div",{className:"flex justify-between items-center my-2",children:[e.jsx("p",{className:" mx-2 mt-6",children:"Courses"}),e.jsxs("div",{className:" mx-2 flex gap-6 mt-4",children:[e.jsx("button",{onClick:E,children:e.jsx("img",{className:"size-8",src:k,alt:"Pdf image"})}),e.jsx(M,{data:n(),filename:"PMC_courses.csv",className:"cursor-pointer",target:"_blank",children:e.jsx("img",{className:"size-8",src:L,alt:"csv image"})}),e.jsx("button",{onClick:v,children:e.jsx("img",{className:"size-8 ",src:U,alt:"excel image"})})]})]}),e.jsx("div",{className:"mx-1 overflow-auto no-scrollbar  ",children:e.jsxs("table",{className:" w-full",children:[e.jsx("thead",{className:"text-slate-300",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 font-extralight border border-slate-400",children:"User Id"}),e.jsx("th",{className:"font-extralight border border-slate-400 text-nowrap",children:"First Name"}),e.jsx("th",{className:"font-extralight border border-slate-400 text-nowrap",children:"Last Name"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Email"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Phone"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Topic"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Type"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Date"}),e.jsx("th",{className:"font-extralight border border-slate-400",children:"Action"})]})}),e.jsx("tbody",{className:"text-slate-400 ",children:c&&c.map((s,l)=>e.jsxs("tr",{className:" text-nowrap text-center",children:[e.jsx("td",{className:"border border-slate-400",children:s._id}),e.jsx("td",{className:"border border-slate-400 capitalize",children:s.fname}),e.jsx("td",{className:"border border-slate-400 capitalize",children:s.lname}),e.jsx("td",{className:"border border-slate-400",children:s.email}),e.jsx("td",{className:"border border-slate-400",children:s.phone}),e.jsx("td",{className:"border border-slate-400  capitalize",children:s.mainTopic}),e.jsxs("td",{className:"border border-slate-400 capitalize",children:[" ",s.type]}),e.jsx("td",{className:"border border-slate-400 text-slate-500 ",children:j(s.date)}),e.jsxs("td",{className:" border-b border-r border-slate-400 flex items-center justify-evenly  ",children:[N&&e.jsx("p",{onClick:()=>S(s.content,s.mainTopic,s.type,s._id,s.completed,s.end),className:" cursor-pointer p-2  text-green-600 ",children:e.jsx($,{size:24})}),f&&e.jsx("p",{onClick:()=>T(s._id),className:"cursor-pointer size-6",children:e.jsx("img",{src:F,alt:"delete image"})})]})]},l))})]})})]}),d&&e.jsx(I,{onClose:P,title:"Course",onDelete:u})]})};export{B as default};
